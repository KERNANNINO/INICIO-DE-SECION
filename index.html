<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inicio de Sesi√≥n y Registro</title>
    <link rel="stylesheet" href="G:\html proyectos\estilos.css">
</head>
<body>
    <div class="contenedor">
        
        <div class="caja-inicio">
            <h1>Iniciar Sesi√≥n</h1>
            <form id="formularioInicio">
                <label for="usuarioInicio">Nombre de Usuario:</label>
                <input type="text" id="usuarioInicio" name="usuarioInicio" required>
                
                <label for="contrase√±aInicio">Contrase√±a:</label>
                <div style="position: relative;">
                    <input type="password" id="contrase√±aInicio" name="contrase√±aInicio" required>
                    <span class="mostrar-contrase√±a" onclick="mostrarContrase√±a('contrase√±aInicio')">üëÅÔ∏è</span>
                </div>
                
                <button type="submit">Iniciar Sesi√≥n</button>
                <div class="enlaces">
                    <a href="#" onclick="mostrarRegistro()">Crear una nueva cuenta</a>
                    <a href="#" onclick="olvidarContrase√±a()">¬øOlvidaste tu contrase√±a?</a>
                </div>
                <p class="error oculto" id="mensajeError">Demasiados intentos fallidos. Por favor, int√©ntelo m√°s tarde.</p>
            </form>
        </div>

        
        <div class="caja-registro oculto" id="cajaRegistro">
            <h2>Crear Cuenta</h2>
            <form id="formularioRegistro">
                <label for="nombre">Nombre:</label>
                <input type="text" id="nombre" name="nombre" required>

                <label for="apellido">Apellido:</label>
                <input type="text" id="apellido" name="apellido" required>

                <label for="fechaNacimiento">Fecha de Nacimiento:</label>
                <input type="date" id="fechaNacimiento" name="fechaNacimiento" required>

                <label for="correoRegistro">Correo Electr√≥nico:</label>
                <input type="email" id="correoRegistro" name="correoRegistro" readonly required>

                <label for="contrase√±aRegistro">Contrase√±a:</label>
                <div style="position: relative;">
                    <input type="password" id="contrase√±aRegistro" name="contrase√±aRegistro" required>
                    <span class="mostrar-contrase√±a" onclick="mostrarContrase√±a('contrase√±aRegistro')">üëÅÔ∏è</span>
                </div>

                <button type="submit">Crear Cuenta</button>
            </form>
        </div>
    </div>

    <script>
        let intentosInicio = 0;
        const maxIntentos = 3;

        function mostrarRegistro() {
            document.getElementById('formularioInicio').parentElement.classList.add('oculto');
            document.getElementById('cajaRegistro').classList.remove('oculto');
        }

        function olvidarContrase√±a() {
            alert('Por favor, contacte con soporte para restablecer su contrase√±a.');
        }

        function mostrarContrase√±a(campoId) {
            const campoContrase√±a = document.getElementById(campoId);
            const tipoCampo = campoContrase√±a.getAttribute('type');
            if (tipoCampo === 'password') {
                campoContrase√±a.setAttribute('type', 'text');
            } else {
                campoContrase√±a.setAttribute('type', 'password');
            }
        }

        
        document.getElementById('nombre').addEventListener('input', generarCorreo);
        document.getElementById('apellido').addEventListener('input', generarCorreo);
        document.getElementById('fechaNacimiento').addEventListener('input', generarCorreo);

        function generarCorreo() {
            const nombre = document.getElementById('nombre').value;
            const apellido = document.getElementById('apellido').value;
            const fechaNacimiento = document.getElementById('fechaNacimiento').value;
            let correo = '';
            
            if (nombre && apellido && fechaNacimiento) {
                const a√±o = new Date(fechaNacimiento).getFullYear().toString().slice(-2);
                const correoNombre = nombre.slice(-4).toLowerCase();
                const correoApellido = apellido.slice(0, 3).toLowerCase();
                correo = `${correoApellido}${correoNombre}${a√±o}@gmail.com`;
                document.getElementById('correoRegistro').value = correo;
            }
        }

        document.getElementById('formularioRegistro').addEventListener('submit', function(event) {
            event.preventDefault();

            const correo = document.getElementById('correoRegistro').value;
            const contrase√±a = document.getElementById('contrase√±aRegistro').value;

            const regexContrase√±a = /^(?=.*[a-zA-Z])(?=.*\d)(?=.*[@$!%*?&.,_-]).{8,}$/;

            if (!regexContrase√±a.test(contrase√±a)) {
                alert('La contrase√±a debe tener al menos 8 caracteres, incluyendo letras, n√∫meros y caracteres especiales.');
                return;
            }

            
            localStorage.setItem('correoRegistrado', correo);
            localStorage.setItem('contrase√±aRegistrada', contrase√±a);

            console.log('Usuario creado:', correo);
            console.log('Contrase√±a:', contrase√±a);

            alert('Cuenta creada con √©xito. Ahora puedes iniciar sesi√≥n.');

            
            document.getElementById('cajaRegistro').classList.add('oculto');
            document.getElementById('formularioInicio').parentElement.classList.remove('oculto');
        });

        document.getElementById('formularioInicio').addEventListener('submit', function(event) {
            event.preventDefault();

            if (intentosInicio >= maxIntentos) {
                document.getElementById('mensajeError').classList.remove('oculto');
                return;
            }

            const usuarioInicio = document.getElementById('usuarioInicio').value.toLowerCase();
            const contrase√±aInicio = document.getElementById('contrase√±aInicio').value;

            const correoGuardado = localStorage.getItem('correoRegistrado');
            const contrase√±aGuardada = localStorage.getItem('contrase√±aRegistrada');

            if (usuarioInicio === correoGuardado && contrase√±aInicio === contrase√±aGuardada) {
                alert('Inicio de sesi√≥n exitoso');
                console.log('Inicio de sesi√≥n:', { usuarioInicio, contrase√±aInicio });
                intentosInicio = 0; 
            } else {
                intentosInicio++;
                if (intentosInicio >= maxIntentos) {
                    document.getElementById('mensajeError').classList.remove('oculto');
                } else {
                    alert(`Correo o contrase√±a incorrectos. Intento ${intentosInicio} de ${maxIntentos}.`);
                }
            }
        });
    </script>
</body>
</html>
